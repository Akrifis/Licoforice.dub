<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Смотреть аниме</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="container">
            <h1><a href="index.html">AnimeHub</a></h1>
        </div>
    </header>

    <main class="container">
        <div id="anime-info">
            <h2 id="anime-title"></h2>
            <div class="video-container">
                <video id="video-player" controls>
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
            <div id="episodes-list"></div>
        </div>
    </main>

    <script src="js/storage.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const animeId = params.get('id');
            const episodeNum = params.get('episode');
            
            const anime = getAnimeById(animeId);
            if (!anime) return window.location = 'index.html';
            
            document.getElementById('anime-title').textContent = anime.title;
            
            if (episodeNum) {
                const episode = anime.episodes.find(ep => ep.number == episodeNum);
                if (episode) {
                    const player = document.getElementById('video-player');
                    player.src = episode.videoUrl;
                    player.poster = anime.posterUrl;
                }
            }
            
            // Список серий
            const episodesList = document.getElementById('episodes-list');
            episodesList.innerHTML = '<h3>Список серий:</h3>';
            
            anime.episodes.forEach(episode => {
                const link = document.createElement('a');
                link.href = `watch.html?id=${anime.id}&episode=${episode.number}`;
                link.textContent = `Серия ${episode.number}`;
                link.className = 'episode-link';
                episodesList.appendChild(link);
            });
        });
    </script>
</body>
</html>
